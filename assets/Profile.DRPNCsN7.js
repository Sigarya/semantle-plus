import{j as e}from"./ui.DDQN6UUz.js";import{r as s}from"./vendor.CJDJhWJD.js";import{C as r,e as a,f as t,d,I as i,H as l}from"./Header.9yKwroLi.js";import{b as n,d as c,s as m,e as o}from"./index.Bo59SwTf.js";import{B as x}from"./button.CyT9Sv66.js";import"./utils.CIxrdROE.js";const p=()=>{const{currentUser:l,refreshUser:o}=n(),{toast:p}=c(),[u,g]=s.useState(l?.username||""),[h,j]=s.useState(""),[b,f]=s.useState(""),[v,N]=s.useState(""),[y,k]=s.useState(!1),[w,S]=s.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(r,{className:"bg-background dark:bg-slate-800 border-primary-200 dark:border-slate-700",children:[e.jsx(a,{children:e.jsx(t,{className:"text-xl",children:"עדכון שם משתמש"})}),e.jsx(d,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),u.trim()&&u!==l?.username){k(!0);try{const{error:e}=await m.from("profiles").update({username:u}).eq("id",l?.id);if(e)throw e;await o(),p({title:"שם המשתמש עודכן",description:"שם המשתמש החדש נשמר בהצלחה"})}catch(s){console.error("Error updating username:",s),p({variant:"destructive",title:"שגיאה",description:s instanceof Error?s.message:"אירעה שגיאה בעדכון שם המשתמש"})}finally{k(!1)}}else p({variant:"destructive",title:"שגיאה",description:"אנא הזן שם משתמש חדש"})},className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"username",className:"text-sm font-medium",children:"שם משתמש חדש"}),e.jsx(i,{id:"username",type:"text",value:u,onChange:e=>g(e.target.value),placeholder:"הזן שם משתמש חדש",dir:"rtl"})]}),e.jsx(x,{type:"submit",className:"bg-primary-500 hover:bg-primary-600 dark:bg-primary-700 dark:hover:bg-primary-600",disabled:y||!u.trim()||u===l?.username,children:y?"מעדכן...":"עדכן שם משתמש"})]})})]}),e.jsxs(r,{className:"bg-background dark:bg-slate-800 border-primary-200 dark:border-slate-700",children:[e.jsx(a,{children:e.jsx(t,{className:"text-xl",children:"עדכון סיסמה"})}),e.jsx(d,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),h&&b&&v)if(b===v)if(b.length<6)p({variant:"destructive",title:"שגיאה",description:"הסיסמה חייבת להכיל לפחות 6 תווים"});else{S(!0);try{const{error:e}=await m.auth.updateUser({password:b});if(e)throw e;p({title:"הסיסמה עודכנה",description:"הסיסמה החדשה נשמרה בהצלחה"}),j(""),f(""),N("")}catch(s){console.error("Error updating password:",s),p({variant:"destructive",title:"שגיאה",description:s instanceof Error?s.message:"אירעה שגיאה בעדכון הסיסמה"})}finally{S(!1)}}else p({variant:"destructive",title:"שגיאה",description:"הסיסמאות החדשות אינן תואמות"});else p({variant:"destructive",title:"שגיאה",description:"אנא מלא את כל השדות"})},className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"new-password",className:"text-sm font-medium",children:"סיסמה חדשה"}),e.jsx(i,{id:"new-password",type:"password",value:b,onChange:e=>f(e.target.value),placeholder:"הזן סיסמה חדשה",dir:"rtl"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"confirm-password",className:"text-sm font-medium",children:"אימות סיסמה חדשה"}),e.jsx(i,{id:"confirm-password",type:"password",value:v,onChange:e=>N(e.target.value),placeholder:"הזן שוב את הסיסמה החדשה",dir:"rtl"})]}),e.jsx(x,{type:"submit",className:"bg-primary-500 hover:bg-primary-600 dark:bg-primary-700 dark:hover:bg-primary-600",disabled:w||!b||!v||b!==v,children:w?"מעדכן...":"עדכן סיסמה"})]})})]})]})},u=()=>{const{currentUser:i}=n(),c=o();return s.useEffect(()=>{i||c("/")},[i,c]),i?e.jsxs("div",{className:"min-h-screen flex flex-col bg-background dark:bg-slate-900",children:[e.jsx(l,{}),e.jsx("main",{className:"flex-grow p-4 md:p-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-center text-primary-600 dark:text-primary-400 mb-8 font-heebo",children:"הפרופיל שלי"}),e.jsxs(r,{className:"bg-background dark:bg-slate-800 border-primary-200 dark:border-slate-700 mb-6",children:[e.jsx(a,{children:e.jsx(t,{className:"text-xl",children:"פרטי משתמש"})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:"שם משתמש:"}),e.jsx("span",{children:i.username}),e.jsx("span",{className:"text-muted-foreground",children:"סוג חשבון:"}),e.jsx("span",{children:i.isAdmin?"מנהל":"שחקן"})]})})]}),e.jsx(p,{}),e.jsxs(r,{className:"bg-background dark:bg-slate-800 border-primary-200 dark:border-slate-700 mt-6",children:[e.jsx(a,{children:e.jsx(t,{className:"text-xl",children:"סטטיסטיקות"})}),e.jsx(d,{children:i.stats?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:i.stats.gamesWon}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"משחקים שנוצחו"})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:i.stats.totalGames}),e.jsx("div",{className:"text-sm text-muted-foreground",children:'סה"כ משחקים'})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsxs("div",{className:"text-3xl font-bold",children:[i.stats.totalGames>0?Math.round(i.stats.gamesWon/i.stats.totalGames*100):0,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"אחוז ניצחונות"})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:i.stats.bestGuessCount||"-"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"ניחושים מינימלי"})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:i.stats.averageGuessCount.toFixed(1)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"ממוצע ניחושים"})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:i.stats.winStreak}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"רצף ניצחונות"})]})]}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"אין נתונים זמינים. שחק משחק כדי לראות את הסטטיסטיקות שלך!"})})]})]})}),e.jsxs("footer",{className:"p-4 border-t border-primary-200 dark:border-slate-700 text-center text-sm text-muted-foreground",children:["סמנטעל + © ",(new Date).getFullYear()]})]}):null};export{u as default};

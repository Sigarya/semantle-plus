import{j as e}from"./ui.DDQN6UUz.js";import{r as s}from"./vendor.CJDJhWJD.js";import{k as t,g as a,B as r,j as l,I as c,c as n,a as i,l as o,m as d,h as x,u as m}from"./index.DNTnC8Xv.js";import{C as h,b as j,c as u,a as p,P as g}from"./PageLayout.DUHnw4gy.js";import{U as y}from"./users.DiJrpnrC.js";import{T as N,a as f,b as v,c as b,d as w,e as k}from"./table.E0_fjeSZ.js";import"./utils.CIxrdROE.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=t("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),S=t("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),L=t("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),M=t("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),T=t("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),D=t("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),R=t("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),_=({onCreateRoom:t,onJoinRoom:n,wordDate:i,isLoading:o})=>{const{toast:d}=a(),[x,m]=s.useState("lobby"),[g,N]=s.useState(""),[f,v]=s.useState(""),b=new Date(i).toLocaleDateString("he-IL");return e.jsxs("div",{className:"space-y-4 max-w-2xl mx-auto",children:["lobby"===x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold font-heebo mb-2",children:"×©×—×§ ×¢× ×—×‘×¨×™×"}),e.jsxs("p",{className:"text-muted-foreground",children:["×ž×©×—×§ ×ž×™×•× ",b]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"××™×Ÿ ×¦×•×¨×š ×‘×”×¨×©×ž×” - ×¤×©×•×˜ ×”×›× ×¡ ×©× ×•×ª×ª×—×™×œ ×œ×©×—×§!"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(h,{className:"cursor-pointer transition-all hover:shadow-lg hover:scale-105",onClick:()=>m("create"),children:[e.jsxs(j,{className:"text-center",children:[e.jsx(y,{className:"w-12 h-12 mx-auto mb-2 text-primary-500"}),e.jsx(u,{className:"font-heebo",children:"×¦×•×¨ ×—×“×¨ ×—×“×©"})]}),e.jsxs(p,{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"×¦×•×¨ ×—×“×¨ ×—×“×© ×•×©×ª×£ ××ª ×”×§×•×“ ×¢× ×”×—×‘×¨×™× ×©×œ×š"}),e.jsxs(r,{className:"w-full",children:["×¦×•×¨ ×—×“×¨",e.jsx(C,{className:"w-4 h-4 mr-2"})]})]})]}),e.jsxs(h,{className:"cursor-pointer transition-all hover:shadow-lg hover:scale-105",onClick:()=>m("join"),children:[e.jsxs(j,{className:"text-center",children:[e.jsx(R,{className:"w-12 h-12 mx-auto mb-2 text-primary-500"}),e.jsx(u,{className:"font-heebo",children:"×”×¦×˜×¨×£ ×œ×—×“×¨ ×§×™×™×"})]}),e.jsxs(p,{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"×”×–×Ÿ ×§×•×“ ×—×“×¨ ×©×§×™×‘×œ×ª ×ž×—×‘×¨ ×•×”×¦×˜×¨×£ ×œ×ž×©×—×§"}),e.jsxs(r,{variant:"outline",className:"w-full",children:["×”×¦×˜×¨×£ ×œ×—×“×¨",e.jsx(R,{className:"w-4 h-4 mr-2"})]})]})]})]})]}),"create"===x&&e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(u,{className:"font-heebo text-center",children:"×¦×•×¨ ×—×“×¨ ×—×“×©"})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"nickname",children:"×”×©× ×©×œ×š ×‘×ž×©×—×§"}),e.jsx(c,{id:"nickname",value:g,onChange:e=>N(e.target.value),placeholder:"×”×›× ×¡ ×©× ×œ×ª×¦×•×’×”...",maxLength:20,dir:"rtl"})]}),e.jsx("div",{className:"bg-muted p-4 rounded-md",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"×œ××—×¨ ×™×¦×™×¨×ª ×”×—×“×¨ ×ª×§×‘×œ ×§×•×“ ×—×“×¨ ×™×™×—×•×“×™ ×©×ª×•×›×œ ×œ×©×ª×£ ×¢× ×”×—×‘×¨×™× ×©×œ×š. ×›×œ ×”×©×—×§× ×™× ×™×¨××• ××ª ×”× ×™×—×•×©×™× ×©×œ ×›×•×œ× ×‘×–×ž×Ÿ ××ž×ª!"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{onClick:()=>{g.trim()?t(g.trim()):d({title:"×©× ×—×¡×¨",description:"×™×© ×œ×”×›× ×™×¡ ×©× ×œ×ª×¦×•×’×” ×‘×ž×©×—×§",variant:"destructive"})},disabled:o||!g.trim(),className:"flex-1",children:o?"×™×•×¦×¨ ×—×“×¨...":"×¦×•×¨ ×—×“×¨"}),e.jsx(r,{variant:"outline",onClick:()=>m("lobby"),disabled:o,children:"×—×–×•×¨"})]})]})]}),"join"===x&&e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(u,{className:"font-heebo text-center",children:"×”×¦×˜×¨×£ ×œ×—×“×¨ ×§×™×™×"})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"room-code",children:"×§×•×“ ×”×—×“×¨"}),e.jsx(c,{id:"room-code",value:f,onChange:e=>v(e.target.value.toUpperCase()),placeholder:"×”×›× ×¡ ×§×•×“ ×—×“×¨ (×œ×ž×©×œ: ABC123)",maxLength:6,className:"text-center font-mono text-lg"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"join-nickname",children:"×”×©× ×©×œ×š ×‘×ž×©×—×§"}),e.jsx(c,{id:"join-nickname",value:g,onChange:e=>N(e.target.value),placeholder:"×”×›× ×¡ ×©× ×œ×ª×¦×•×’×”...",maxLength:20,dir:"rtl"})]}),e.jsx("div",{className:"bg-muted p-4 rounded-md",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"×”×–×Ÿ ××ª ×§×•×“ ×”×—×“×¨ ×©×§×™×‘×œ×ª ×ž×”×—×‘×¨ ×©×™×¦×¨ ××ª ×”×—×“×¨ ×•××ª ×”×©× ×©×‘×¨×¦×•× ×š ×©×™×•×¤×™×¢ ×‘×ž×©×—×§."})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{onClick:()=>{g.trim()?f.trim()?n(f.trim().toUpperCase(),g.trim()):d({title:"×§×•×“ ×—×“×¨ ×—×¡×¨",description:"×™×© ×œ×”×›× ×™×¡ ×§×•×“ ×—×“×¨ ×ª×§×™×Ÿ",variant:"destructive"}):d({title:"×©× ×—×¡×¨",description:"×™×© ×œ×”×›× ×™×¡ ×©× ×œ×ª×¦×•×’×” ×‘×ž×©×—×§",variant:"destructive"})},disabled:o||!g.trim()||!f.trim(),className:"flex-1",children:o?"×ž×¦×˜×¨×£...":"×”×¦×˜×¨×£ ×œ×—×“×¨"}),e.jsx(r,{variant:"outline",onClick:()=>m("lobby"),disabled:o,children:"×—×–×•×¨"})]})]})]})]})},F=i("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function E({className:s,variant:t,...a}){return e.jsx("div",{className:n(F({variant:t}),s),...a})}const H=()=>{const{gameState:t,makeGuess:l,leaveRoom:n,timeoutState:i,dismissTimeoutWarning:d}=o(),{toast:x}=a(),[m,g]=s.useState(""),[C,R]=s.useState(!1),[_,F]=s.useState(!1),H=s.useMemo(()=>[...t.guesses].sort((e,s)=>s.similarity-e.similarity),[t.guesses]),P=s.useCallback(async()=>{const e=t.room?.room_code||"";if(e)try{if(navigator.clipboard&&"function"==typeof navigator.clipboard.writeText)await navigator.clipboard.writeText(e);else{const s=document.createElement("textarea");s.value=e,s.setAttribute("readonly",""),s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select();try{document.execCommand("copy")}finally{document.body.removeChild(s)}}F(!0),setTimeout(()=>F(!1),2e3)}catch(s){console.error("Failed to copy room code:",s);try{window.prompt("×”×¢×ª×§ ××ª ×§×•×“ ×”×—×“×¨:",e)}catch(a){}}},[t.room?.room_code]),V=s.useCallback(e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`,[]),$=s.useCallback(async e=>{if(e.preventDefault(),m.trim()&&!C){console.log("Submitting guess:",m),console.log("Current game state:",t),R(!0);try{await l(m.trim()),g("")}catch(s){const e=s instanceof Error?s.message:"×©×’×™××” ×‘× ×™×—×•×© ×”×ž×™×œ×”";x({title:"×©×’×™××”",description:e,variant:"destructive"})}finally{R(!1)}}},[m,C,l,x,t]);return t.room?e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[i?.isWarning&&e.jsxs(h,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(j,{className:"text-center",children:e.jsx(u,{className:"text-yellow-800 flex items-center justify-center gap-2",children:"â° ××–×”×¨×ª ××™ ×¤×¢×™×œ×•×ª"})}),e.jsxs(p,{className:"text-center",children:[e.jsx("p",{className:"text-yellow-700 mb-4",children:"×œ× × ×©×œ×—×” ××£ ×ž×™×œ×” ×™×•×ª×¨ ×ž×“×™ ×–×ž×Ÿ. ×× ××ª× ×¢×“×™×™×Ÿ ×ž×©×—×§×™×, ×œ×—×¦×• ×¢×œ ×—×–×¨×” ×œ×ž×©×—×§ ×¢×œ ×ž× ×ª ×œ×”×©××™×¨ ××ª ×”×—×“×¨ ×¤×ª×•×—"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-800 mb-4",children:V(i.warningTimeLeft)}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsx(r,{onClick:n,variant:"outline",children:"×¢×–×•×‘ ×—×“×¨"}),e.jsx(r,{onClick:d,className:"bg-yellow-600 hover:bg-yellow-700",children:"×—×–×¨×” ×œ×ž×©×—×§"})]})]})]}),i?.isClosing&&e.jsxs(h,{className:"border-red-200 bg-red-50",children:[e.jsx(j,{className:"text-center",children:e.jsx(u,{className:"text-red-800 flex items-center justify-center gap-2",children:"ðŸš¨ ×”×—×“×¨ × ×¡×’×¨ ×‘×§×¨×•×‘"})}),e.jsxs(p,{className:"text-center",children:[e.jsx("p",{className:"text-red-700 mb-4",children:"×”×—×“×¨ ×™×™×¡×’×¨ ××•×˜×•×ž×˜×™×ª ×‘×’×œ×œ ××™ ×¤×¢×™×œ×•×ª"}),e.jsx("div",{className:"text-2xl font-bold text-red-800 mb-4",children:V(i.closingTimeLeft)}),e.jsx(r,{onClick:n,variant:"outline",children:"×¢×–×•×‘ ×—×“×¨"})]})]}),e.jsx(h,{children:e.jsxs(j,{className:"text-center",children:[e.jsxs(u,{className:"flex items-center justify-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"×—×“×¨ ×ž×¨×•×‘×” ×ž×©×ª×ª×¤×™×"]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["×§×•×“ ×—×“×¨:",e.jsxs("button",{onClick:P,className:"inline-flex items-center gap-1 ml-1 hover:bg-muted px-2 py-1 rounded transition-colors",title:"×œ×—×¥ ×œ×”×¢×ª×§×”",children:[e.jsx(E,{variant:"secondary",className:"cursor-pointer hover:bg-muted-foreground/20",children:t.room.room_code}),_?e.jsx(S,{className:"h-3 w-3 text-green-500"}):e.jsx(L,{className:"h-3 w-3"})]}),_&&e.jsx("span",{className:"text-xs text-green-600 ml-2",children:"×”×§×•×“ ×”×•×¢×ª×§"})]}),e.jsxs("span",{children:["×ª××¨×™×š: ",new Date(t.room.word_date).toLocaleDateString("he-IL")]}),e.jsxs("span",{children:["×©×—×§× ×™×: ",t.players.length]})]})]})}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"×©×—×§× ×™× ×‘×—×“×¨"]})}),e.jsx(p,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:t.players.map(s=>e.jsxs(E,{variant:s.id===t.currentPlayer?.id?"default":"secondary",className:"flex items-center gap-1",children:[s.nickname,s.id===t.currentPlayer?.id&&e.jsx("span",{className:"text-xs",children:"(××ª×”)"})]},s.id))})})]}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"×”×›× ×¡ × ×™×—×•×©"]})}),e.jsx(p,{children:e.jsxs("form",{onSubmit:$,className:"flex gap-2",children:[e.jsx(c,{value:m,onChange:e=>g(e.target.value),placeholder:"×”×§×œ×“ ×ž×™×œ×”...",disabled:C||t.isComplete,className:"flex-1"}),e.jsx(r,{type:"submit",disabled:C||t.isComplete||!m.trim(),className:"min-w-[100px]",children:C?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-4 w-4 animate-spin mr-2"}),"×©×•×œ×—..."]}):"×©×œ×—"})]})})]}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"× ×™×—×•×©×™× (",t.guesses.length,")"]})}),e.jsx(p,{children:0===t.guesses.length?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"×¢×“×™×™×Ÿ ××™×Ÿ × ×™×—×•×©×™×. ×ª×”×™×” ×”×¨××©×•×Ÿ!"}):e.jsx("div",{className:"border rounded-md overflow-x-auto",children:e.jsxs(N,{children:[e.jsx(f,{children:e.jsxs(v,{className:"border-b",children:[e.jsx(b,{className:"text-right w-12 py-2 px-2",children:"#"}),e.jsx(b,{className:"text-right w-24 py-2 px-2",children:"×ž×™×œ×”"}),e.jsx(b,{className:"text-right w-28 py-2 px-2",children:"×©×—×§×Ÿ"}),e.jsx(b,{className:"text-center w-20 py-2 px-2",children:"×§×¨×‘×”"}),e.jsx(b,{className:"text-center w-28 py-2 px-2",children:"×ž×ª×—×ž×?"})]})}),e.jsx(w,{children:H.map((s,t)=>e.jsxs(v,{className:""+(s.is_correct?"bg-green-500/20":""),children:[e.jsx(k,{className:"w-12 py-1 px-2 text-xs",children:s.guess_order}),e.jsx(k,{className:"w-24 font-medium py-1 px-2 text-xs truncate",children:s.guess_word}),e.jsx(k,{className:"w-28 py-1 px-2 text-xs",children:e.jsx(E,{variant:"outline",className:"text-xs",children:s.player_nickname})}),e.jsx(k,{className:"w-20 text-center py-1 px-2 text-xs",children:`${(100*s.similarity).toFixed(2)}%`}),e.jsx(k,{className:"w-28 text-center py-1 px-2",children:s.rank&&s.rank>0?e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx("div",{className:"relative w-16 h-3 bg-muted rounded-sm flex-shrink-0",children:e.jsx("div",{className:"absolute top-0 left-0 h-full bg-green-500 rounded-sm transition-all duration-200",style:{width:`${Math.min(s.rank/1e3*100,100)}%`}})}),e.jsxs("span",{className:"text-xs text-muted-foreground font-heebo whitespace-nowrap",children:[s.rank,"/1000"]})]}):e.jsx("span",{className:"text-xs text-muted-foreground font-heebo",children:"×¨×—×•×§"})})]},s.id))})]})})})]}),t.isComplete&&e.jsxs(h,{className:"border-green-200 bg-green-50",children:[e.jsx(j,{className:"text-center",children:e.jsxs(u,{className:"text-green-800 flex items-center justify-center gap-2",children:[e.jsx(D,{className:"h-6 w-6"}),"×”×ž×©×—×§ ×”×¡×ª×™×™×!"]})}),e.jsxs(p,{className:"text-center",children:[e.jsx("p",{className:"text-green-700 mb-4",children:"×ž×™×©×”×• × ×™×—×© ××ª ×”×ž×™×œ×” ×”× ×›×•× ×”! ×”×ž×©×—×§ ×”×¡×ª×™×™×."}),e.jsx(r,{onClick:n,variant:"outline",children:"×¢×–×•×‘ ×—×“×¨"})]})]}),!t.isComplete&&e.jsx("div",{className:"text-center",children:e.jsx(r,{onClick:n,variant:"outline",children:"×¢×–×•×‘ ×—×“×¨"})})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"×˜×•×¢×Ÿ ×ž×©×—×§ ×ž×¨×•×‘×” ×ž×©×ª×ª×¤×™×..."})]})})},P=()=>{const[t]=d();x();const{toast:r}=a(),{gameState:l,isLoading:c,createRoom:n,joinRoom:i}=o(),{getCurrentGameDate:h}=m(),[j,u]=s.useState("");s.useEffect(()=>{const e=t.get("date");u(e||h())},[t,h]);return e.jsx(g,{children:e.jsx("div",{className:"space-y-6",children:l.room?e.jsx(H,{}):e.jsx(_,{onCreateRoom:async e=>{try{const s=await n(e,j);r({title:"×—×“×¨ × ×•×¦×¨ ×‘×”×¦×œ×—×”! ðŸŽ‰",description:`×§×•×“ ×”×—×“×¨: ${s}`,duration:5e3})}catch(s){console.error("Error creating room:",s)}},onJoinRoom:async(e,s)=>{try{await i(e,s),r({title:"×”×¦×˜×¨×¤×ª ×œ×—×“×¨! ðŸŽ‰",description:"×”×ž×©×—×§ ×”×§×‘×•×¦×ª×™ ×ž×ª×—×™×œ",duration:3e3})}catch(t){console.error("Error joining room:",t)}},wordDate:j,isLoading:c})})})};export{P as default};

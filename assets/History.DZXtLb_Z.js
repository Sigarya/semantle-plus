import{j as e}from"./ui.DDQN6UUz.js";import{r}from"./vendor.CJDJhWJD.js";import{f as s,s as t,u as a,g as i,h as o,i as d,B as n}from"./index.DUqZId71.js";import{C as l,b as c,c as m,a as x}from"./Header.AqZPaoJK.js";import{T as p,a as h,b as g,c as j,d as u,e as f}from"./table.Cy8YWs1g.js";import{P as b}from"./PageLayout.D2whWgk0.js";import"./utils.CIxrdROE.js";const y=()=>{const{dailyWords:b,loadHistoricalGame:y}=a(),{isGameCompleted:w}=(()=>{const{currentUser:e}=s(),[a,i]=r.useState([]),[o,d]=r.useState(!1),n=async()=>{if(e){d(!0);try{const{data:r,error:s}=await t.from("daily_scores").select("word_date, guesses_count, completion_time").eq("user_id",e.id).order("word_date",{ascending:!1});s?(console.error("Error fetching user completions:",s),i([])):i(r||[])}catch(r){console.error("Error fetching user completions:",r),i([])}finally{d(!1)}}else i([])};return r.useEffect(()=>{n()},[e]),{completions:a,isLoading:o,isGameCompleted:e=>a.some(r=>r.word_date===e),getCompletionInfo:e=>a.find(r=>r.word_date===e)||null,refreshCompletions:n}})(),{toast:k}=i(),N=o(),[v,_]=r.useState(!1),S=[...b].sort((e,r)=>new Date(r.date).getTime()-new Date(e.date).getTime());return e.jsxs(l,{className:"bg-background dark:bg-slate-800 border-primary-200 dark:border-slate-700",children:[e.jsx(c,{children:e.jsx(m,{className:"text-xl font-heebo",children:"היסטורית משחקים"})}),e.jsx(x,{children:0===S.length?e.jsx("div",{className:"text-center py-6 text-muted-foreground",children:"אין משחקים קודמים זמינים כרגע"}):e.jsxs(p,{children:[e.jsx(h,{children:e.jsxs(g,{children:[e.jsx(j,{className:"text-right",children:"תאריך"}),e.jsx(j,{className:"text-right",children:"פעולות"})]})}),e.jsx(u,{children:S.map(r=>{const s=new Date(r.date),t=new Date;t.setHours(0,0,0,0);const a=s<t,i=w(r.date);return e.jsxs(g,{children:[e.jsx(f,{children:d(new Date(r.date))}),e.jsxs(f,{children:[a&&e.jsx(n,{variant:"outline",size:"sm",onClick:()=>(async e=>{_(!0);try{await y(e),N("/"),k({title:"משחק היסטורי נטען",description:`המשחק מתאריך ${d(new Date(e))} נטען בהצלחה`})}catch(r){k({variant:"destructive",title:"שגיאה",description:r instanceof Error?r.message:"אירעה שגיאה בטעינת המשחק"})}finally{_(!1)}})(r.date),disabled:v,className:i?"border-green-500 text-green-600 hover:bg-green-50 dark:text-green-400 dark:border-green-400 dark:hover:bg-green-900/20":"",children:v?"טוען...":i?"הושלם 🎉":"שחק"}),!a&&r.date===t.toISOString().split("T")[0]&&e.jsx("span",{className:"text-primary-600 dark:text-primary-400",children:"משחק נוכחי"}),!a&&r.date!==t.toISOString().split("T")[0]&&e.jsx("span",{className:"text-muted-foreground",children:"טרם זמין"})]})]},r.date)})})]})})]})},w=()=>e.jsxs(b,{title:"היסטורית משחקים",children:[e.jsx("div",{className:"max-w-3xl mx-auto mb-6 p-4 bg-primary-50 dark:bg-slate-800 rounded-md border border-primary-200 dark:border-slate-700 text-center",children:e.jsxs("p",{className:"text-primary-800 dark:text-primary-300",children:["רוצים לנסות שוב? פספסתם את הסמנטעל אתמול? כאן תוכלו לשחק בגרסאות קודמות של המשחק היומי.",e.jsx("br",{}),"בכל יום קצת אחרי השעה 3:00 יעלה המשחק של אתמול ותוכלו למצוא אותו גם כאן וגם בדף הראשי."]})}),e.jsx(y,{})]});export{w as default};

import{j as e}from"./ui.DDQN6UUz.js";import{r}from"./vendor.CJDJhWJD.js";import{C as s,b as a,c as t,a as d,H as l}from"./Header.AqZPaoJK.js";import{f as i,g as n,I as c,B as o,s as m,h as x}from"./index.DUqZId71.js";import"./utils.CIxrdROE.js";const h=()=>{const{currentUser:l,refreshUser:x}=i(),{toast:h}=n(),[p,u]=r.useState(l?.username||""),[g,b]=r.useState(""),[j,f]=r.useState(""),[v,N]=r.useState(""),[y,k]=r.useState(!1),[w,S]=r.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(s,{className:"bg-background dark:bg-slate-800 border-primary-200 dark:border-slate-700",children:[e.jsx(a,{children:e.jsx(t,{className:"text-xl",children:"עדכון שם משתמש"})}),e.jsx(d,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),p.trim()&&p!==l?.username){k(!0);try{const{error:e}=await m.from("profiles").update({username:p}).eq("id",l?.id);if(e)throw e;await x(),h({title:"שם המשתמש עודכן",description:"שם המשתמש החדש נשמר בהצלחה"})}catch(r){console.error("Error updating username:",r),h({variant:"destructive",title:"שגיאה",description:r instanceof Error?r.message:"אירעה שגיאה בעדכון שם המשתמש"})}finally{k(!1)}}else h({variant:"destructive",title:"שגיאה",description:"אנא הזן שם משתמש חדש"})},className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"username",className:"text-sm font-medium",children:"שם משתמש חדש"}),e.jsx(c,{id:"username",type:"text",value:p,onChange:e=>u(e.target.value),placeholder:"הזן שם משתמש חדש",dir:"rtl"})]}),e.jsx(o,{type:"submit",className:"bg-primary-500 hover:bg-primary-600 dark:bg-primary-700 dark:hover:bg-primary-600",disabled:y||!p.trim()||p===l?.username,children:y?"מעדכן...":"עדכן שם משתמש"})]})})]}),e.jsxs(s,{className:"bg-background dark:bg-slate-800 border-primary-200 dark:border-slate-700",children:[e.jsx(a,{children:e.jsx(t,{className:"text-xl",children:"עדכון סיסמה"})}),e.jsx(d,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),g&&j&&v)if(j===v)if(j.length<6)h({variant:"destructive",title:"שגיאה",description:"הסיסמה חייבת להכיל לפחות 6 תווים"});else{S(!0);try{const{error:e}=await m.auth.updateUser({password:j});if(e)throw e;h({title:"הסיסמה עודכנה",description:"הסיסמה החדשה נשמרה בהצלחה"}),b(""),f(""),N("")}catch(r){console.error("Error updating password:",r),h({variant:"destructive",title:"שגיאה",description:r instanceof Error?r.message:"אירעה שגיאה בעדכון הסיסמה"})}finally{S(!1)}}else h({variant:"destructive",title:"שגיאה",description:"הסיסמאות החדשות אינן תואמות"});else h({variant:"destructive",title:"שגיאה",description:"אנא מלא את כל השדות"})},className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"new-password",className:"text-sm font-medium",children:"סיסמה חדשה"}),e.jsx(c,{id:"new-password",type:"password",value:j,onChange:e=>f(e.target.value),placeholder:"הזן סיסמה חדשה",dir:"rtl"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"confirm-password",className:"text-sm font-medium",children:"אימות סיסמה חדשה"}),e.jsx(c,{id:"confirm-password",type:"password",value:v,onChange:e=>N(e.target.value),placeholder:"הזן שוב את הסיסמה החדשה",dir:"rtl"})]}),e.jsx(o,{type:"submit",className:"bg-primary-500 hover:bg-primary-600 dark:bg-primary-700 dark:hover:bg-primary-600",disabled:w||!j||!v||j!==v,children:w?"מעדכן...":"עדכן סיסמה"})]})})]})]})},p=()=>{const{currentUser:n}=i(),c=x();return r.useEffect(()=>{n||c("/")},[n,c]),n?e.jsxs("div",{className:"min-h-screen flex flex-col bg-background dark:bg-slate-900",children:[e.jsx(l,{}),e.jsx("main",{className:"flex-grow p-4 md:p-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-center text-primary-600 dark:text-primary-400 mb-8 font-heebo",children:"הפרופיל שלי"}),e.jsxs(s,{className:"bg-background dark:bg-slate-800 border-primary-200 dark:border-slate-700 mb-6",children:[e.jsx(a,{children:e.jsx(t,{className:"text-xl",children:"פרטי משתמש"})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:"שם משתמש:"}),e.jsx("span",{children:n.username}),e.jsx("span",{className:"text-muted-foreground",children:"סוג חשבון:"}),e.jsx("span",{children:n.isAdmin?"מנהל":"שחקן"})]})})]}),e.jsx(h,{}),e.jsxs(s,{className:"bg-background dark:bg-slate-800 border-primary-200 dark:border-slate-700 mt-6",children:[e.jsx(a,{children:e.jsx(t,{className:"text-xl",children:"סטטיסטיקות"})}),e.jsx(d,{children:n.stats?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:n.stats.gamesWon}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"משחקים שנוצחו"})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:n.stats.totalGames}),e.jsx("div",{className:"text-sm text-muted-foreground",children:'סה"כ משחקים'})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsxs("div",{className:"text-3xl font-bold",children:[n.stats.totalGames>0?Math.round(n.stats.gamesWon/n.stats.totalGames*100):0,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"אחוז ניצחונות"})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:n.stats.bestGuessCount||"-"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"ניחושים מינימלי"})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:n.stats.averageGuessCount.toFixed(1)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"ממוצע ניחושים"})]}),e.jsxs("div",{className:"bg-primary-100 dark:bg-primary-900/20 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:n.stats.winStreak}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"רצף ניצחונות"})]})]}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"אין נתונים זמינים. שחק משחק כדי לראות את הסטטיסטיקות שלך!"})})]})]})}),e.jsx("footer",{className:"p-4 border-t border-primary-200 dark:border-slate-700 text-center text-sm text-muted-foreground",children:e.jsxs("div",{className:"space-y-1 leading-relaxed rtl text-sm",children:[e.jsx("a",{href:"https://github.com/sigarya",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-primary",children:"Made by Sigarya"}),e.jsx("br",{}),"פרויקט עצמאי בהשראת ",e.jsx("a",{href:"https://semantle.com",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-primary",children:"Semantle"})," ","(David Turner).",e.jsx("br",{}),"מבוסס על הגרסה העברית והמילים היומיות של ",e.jsx("a",{href:"https://semantle.ishefi.com",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-primary",children:"סמנטעל (ishefi)"}),", והמודל של ",e.jsx("a",{href:"https://x.com/IddoYadlin",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-primary",children:"Iddo Yadlin"}),".",e.jsx("br",{}),e.jsx("a",{href:"https://github.com/Sigarya/semantle-plus",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-primary",children:"קוד מקור"})]})})]}):null};export{p as default};
